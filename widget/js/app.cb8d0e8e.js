(function(e){function t(t){for(var o,r,c=t[0],l=t[1],s=t[2],d=0,p=[];d<c.length;d++)r=c[d],a[r]&&p.push(a[r][0]),a[r]=0;for(o in l)Object.prototype.hasOwnProperty.call(l,o)&&(e[o]=l[o]);u&&u(t);while(p.length)p.shift()();return i.push.apply(i,s||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],o=!0,c=1;c<n.length;c++){var l=n[c];0!==a[l]&&(o=!1)}o&&(i.splice(t--,1),e=r(r.s=n[0]))}return e}var o={},a={app:0},i=[];function r(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=o,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],l=c.push.bind(c);c.push=t,c=c.slice();for(var s=0;s<c.length;s++)t(c[s]);var u=l;i.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";var o=n("04f5"),a=n.n(o);a.a},"04f5":function(e,t,n){},"0ee5":function(e,t,n){"use strict";var o=n("82b9"),a=n.n(o);a.a},"1ff7":function(e,t,n){},"39fb":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAQ9SURBVGhD7ZpNqBZVGMdvqWmRmB9RWhqYkh/oIghXmqvAQKmFZW4sEQXDT3ThQkFRE0wQRdHA3FRitSj6UBeiRK6kFm5SMYX8CNNSTCqs1N9v4MDL3PfOnXnnvHOnuH/4Lc6Zd+acZ87X8zzzdvTqf6xR8Ca8B8fhCtyCe/AP/Aan4TPYDC/BI1ALDYEV8B3Y4aL8AQdgBjwAlWsYbIXfIXTqGnwMb8N0GAEDIGgQjINXYCN8C45UuP8UvAaVGGQjC+FXsPG74FSZCf2gqDR2JZyHYJDTcjy0TY7ClxAa/BwmQQz1hXlwGXz2n+ALi64J8BPYyM/gCLRDj8JOcKRtax9oZBS9AGEqHYUnod1yHd0A2/wCHoJScur8Aj7Q3aX0AwtoMriF2/an0AdakmsiTKcP4EGoWmMgvMhtVhSVu9NX4AOOQZUjkdYU8Lxx3cyyoojcMTTChf2EFT2sRWB/HJ2hVuTR43AdvLFdu1MrClv/nqSUQ57Y3uA5USeNBs8XvYGxVmRJ30m3w/kY67CLqR3gS/Z8ydRyqONoBI2Ev8GRecyKrvQ91G1tpOUBaR+7dGGeAX/gQm/FAaxKb4D9/DopNZFBkT84mJTqK7fff8GgrekL3wsaYjyRR/pcOnmx9DTkPXiNXezr80kppW/Aiy8mpWwNhttwDlyAZTUffMuGyXn0EdhXp1knXQIvPpWUsuWQngR//yOUMUYjgtu+2Ioc2gD+fm1SSikkCh5OSt3LUQmxeqvGNBqxxoqcWgre825SSskLDm8RlTGmVSPUW+B9u5NSSh40XiyqVowpY4QKTuSupJRSiMjMdhRVEWPKGqFWgfe/k5RS+gG8aHzeivIYE8MItR18xrKklJL+lRcLBy8NyjImlhEqBH0vJ6WUNoEXTZ6VUTNjYhph9BrCX9O0nWQu1osnklI5NRpjlBnLCGV44bN8SU1lQtnY2MBluBUl1WhMLCOUh6DPy4wUTfn4I3eFGNKYD2FJUiovp9VZsI+ZrpRZcX9kLjZahi+iXNz27wJkJru9GDxL3fq6yfVr33L5ZLPBH+tEDrSiJpoL9usi5PIHHRVT+95kQrkOMusZ0qdzrMiriWCA77ZZ5oCMIV9sOACPWFFUwTG7CT2ZGtKfsh+OSMtZz/3gQ5yXz1lRsfyaZfueb3ki1y5lKj/4YLoFfiupQk6nLWC7HtBRpnd/+AR8aNs+iTXILEnI89reqxBNjoxhZfCZbOhZiC232LA76aNNhbbIT2J+hrYh56252KYeaEHpUYTDTg5D2z/xmeg2Bxa+kd8Bt0f3d/f7PHINuBPqAJ6BYIBfdV+HSmVq/334C0JHTF7o4uh8rgezHQvAdbUajOwOwVUI94i+k4nBxj8YVC5jfDvqqDT+E6I7jCcc2WnQE98nM6XHbBrTDOA68KORnTXb4XbqZwvXQ55MS6/+w+rouA/fEkkUVd2zTwAAAABJRU5ErkJggg=="},"48cd":function(e,t,n){},"4ab0":function(e,t,n){},"4af2":function(e,t,n){},"4fdf":function(e,t,n){"use strict";var o=n("dcc8"),a=n.n(o);a.a},"56d7":function(e,t,n){"use strict";n.r(t);n("cadf"),n("551c"),n("097d");var o=n("2b0e"),a=n("76a0"),i=n.n(a),r=n("8c4f"),c=(n("aa35"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("router-view")],1)}),l=[],s=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"footer"},[o("div",{staticClass:"title",on:{click:function(t){e.openSelectPanel()}}},[o("i",{staticClass:"left-image"},[e.openSelectPanelFlag?e._e():o("img",{attrs:{src:n("ac39")}}),e.openSelectPanelFlag?o("img",{attrs:{src:n("39fb")}}):e._e()]),e.selectedFloor&&e.selectedFloor.properties?o("span",{staticClass:"name"},[e._v("\n            "+e._s(e.selectedFloor.properties.name)+"--"+e._s(e.selectedFloor.properties.infor)+"\n        ")]):e._e()]),o("div",{directives:[{name:"show",rawName:"v-show",value:e.openSelectPanelFlag,expression:"openSelectPanelFlag"}],staticClass:"content"},e._l(e.flowInfo,function(t){return o("div",{on:{click:function(n){e.selectFloor(t)}}},[t.properties.id==e.selectedFloor.properties.id?o("mt-cell",{attrs:{icon:"success",title:t.properties.name,label:t.properties.infor}}):e._e(),t.properties.id!=e.selectedFloor.properties.id?o("mt-cell",{attrs:{title:t.properties.name,label:t.properties.infor}}):e._e()],1)})),e.selectedPoi?o("div",{staticClass:"footer"},[o("div",{staticClass:"poi-detail"},[o("div",{staticClass:"waper"},[e.selectedPoi?o("div",[e._v(e._s(e.selectedPoi.name))]):e._e(),e.selectedPoi&&e.selectedPoi.address?o("div",[e._v(e._s(e.selectedPoi.address))]):e._e(),e.selectedPoi&&!e.selectedPoi.address?o("div",[e._v("地址(空)")]):e._e()]),o("div",{staticClass:"right-waper"},[o("mt-button",{attrs:{type:"primary",size:"small"}},[e._v("路 线")]),o("mt-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"danger",size:"small"},on:{click:function(t){e.openFloor()}}},[e._v("楼 层")])],1)])]):e._e()])},u=[],d=(n("7f7f"),n("ac6a"),{GETNEARPOINTS:"getNearPoints",FLOORCHANGING:"floorChanging",SELECTPOI:"selectPoi"}),p=n("9393"),f=(n("ffc1"),n("bc3a")),m=n.n(f),h="prod",g="http://localhost:8080",y="/api",v="http://fs-road.navinfo.com/dev/trunk/funWander/service",A="dev"===h?y:v,b={localhost:g,service:{serviceUrl:A},minedata:{serviceUrl:"http://139.199.20.29/data",accessToken:"67f6bfed606941f9a63d26d0ad61de2f",solution:4784}},P=b,w=m.a.create({baseURL:P.service.serviceUrl}),k=function(e,t){var n=e;if(t){for(var o=[],a=Object.entries(t),i=0;i<a.length;i++){var r=Object(p["a"])(a[i],2),c=r[0],l=r[1];o.push("".concat(c,"=").concat(l))}var s=n.indexOf("?")>=0?"&":"?";n=n+s+o.join("&")}return w.get(n).then(function(e){return e.data})},T=function(e,t){return w.post(e,t).then(function(e){return e.data})},j={get:k,post:T},F=n("324a"),O=n.n(F),C=function(e){return O.a.parse(e)},x=function(e){return O.a.stringify(e)},S={wktToGeojson:C,geoJsonToWkt:x},B=n("8788"),_={components:{MtButton:B["a"]},name:"buildingInfos",props:{},data:function(){return{currentBuliding:{},flowInfo:[],selectedFloor:null,openSelectPanelFlag:!0,selectedPoi:null}},methods:{openFloor:function(){this.selectedPoi=null,this.openSelectPanelFlag=!0},openSelectPanel:function(){this.openSelectPanelFlag=!this.openSelectPanelFlag},selectFloor:function(e){e.properties.id!=this.selectedFloor.properties.id&&(this.flowInfo.forEach(function(e){e.selected=!1}),this.selectedFloor=e,this.$bus.$emit(d.FLOORCHANGING,e.properties.id))},loadFloorByBuilding:function(e){return j.get("/indoor/building/floor/".concat(e)).then(function(e){return e&&e.data&&e.data.length>0?e.data.map(function(e){var t=S.wktToGeojson(e.geometry);return{type:"Feature",properties:{id:e.fl_id,infor:e.fl_infor,name:e.fl_name,num:e.fl_num},geometry:t}}):null}).catch(function(e){return console.error(e),null})},loadPoiById:function(e){return j.get("/indoor/building/poi/".concat(e)).then(function(e){return e&&e.data&&e.data.length>0?e.data.map(function(e){return{id:e.poi_id,address:e.address,name:e.name,faceId:e.face_id}}):null}).catch(function(e){return null})}},mounted:function(){var e=this,t=this;this.loadFloorByBuilding(this.$route.query.id).then(function(t){e.flowInfo=t,e.selectedFloor=t[0],e.$bus.$emit(d.FLOORCHANGING,t[0].properties.id)}),this.$bus.$on(d.SELECTPOI,function(e){t.loadPoiById(e.properties.id).then(function(e){e&&(t.selectedPoi=e[0],t.openSelectPanelFlag=!1)})})}},M=_,N=(n("c751"),n("2877")),L=Object(N["a"])(M,s,u,!1,null,"6e03c153",null);L.options.__file="buildingInfos.vue";var I=L.exports,G=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"areaDataList"},e._l(e.areaList,function(t){return n("div",{on:{click:function(n){n.stopPropagation(),e.selectPoint(t)}}},[n("mt-cell",{attrs:{title:t,label:t}},[n("mt-button",{attrs:{type:"primary",size:"small"}},[e._v("设为终点")])],1)],1)}))},R=[],U={name:"areaDataList",props:{},data:function(){return{areaList:[]}},methods:{selectPoint:function(e){console.log(e)}},mounted:function(){var e=this;this.$bus.$on(d.GETNEARPOINTS,function(t){e.areaList=t})}},E=U,Y=(n("afd3"),Object(N["a"])(E,G,R,!1,null,"6ff49569",null));Y.options.__file="areaDataList.vue";var Q=Y.exports,D=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"map-container",attrs:{id:"mapBoxMap"}})},q=[],Z=(n("28a5"),n("e192")),X=n.n(Z),J=function(e){return"".concat(P.minedata.serviceUrl).concat(e,"/{z}/{x}/{y}?token=").concat(P.minedata.accessToken,"&solu=").concat(P.minedata.solution)},z=(J("/Landuse"),J("/Ptline"),J("/Buildingmore"),J("/Railway"),J("/Waterface"),J("/Villtown"),J("/Road"),J("/Worldannotation"),J("/Poi"),J("/Greenface"),J("/Subwaypolygon"),J("/Annotation"),J("/Adminbound"),J("/Waterline"),J("/Worldcountries"),J("/Ptexit"),J("/ResidentialPolygon"),J("/Worldwaterface"),J("/Ptstop"),J("/Adminflag"),J("/Zlevel"),"".concat(P.localhost,"/res/mapbox/sprite/sprite"),"".concat(P.localhost,"/res/mapbox/glyphs/{fontstack}/{range}"),{version:8,sprite:"".concat(P.localhost,"/res/mapbox/sprite/sprite"),glyphs:"".concat(P.localhost,"/res/mapbox/glyphs/{fontstack}/{range}.pbf"),sources:{"raster-tiles":{type:"raster",tiles:["http://rt0.map.gtimg.com/realtimerender?z={z}&x={x}&y={y}&type=vector&style=0","http://rt1.map.gtimg.com/realtimerender?z={z}&x={x}&y={y}&type=vector&style=0","http://rt2.map.gtimg.com/realtimerender?z={z}&x={x}&y={y}&type=vector&style=0","http://rt3.map.gtimg.com/realtimerender?z={z}&x={x}&y={y}&type=vector&style=0"],scheme:"tms",tileSize:256,minZoom:5,maxZoom:18}},layers:[{id:"simple-tiles",type:"raster",source:"raster-tiles"}]}),H=z;X.a.accessToken="pk.eyJ1IjoibWFkc2hhd24iLCJhIjoiY2lqY2ZwcW4zMDAwMXc2a3VybmsxdzU1OSJ9.UTV2YhX9rABrPQIEI2QKwg";var V={name:"MainMap",props:{},mounted:function(){this.createMap()},methods:{createMap:function(){var e=this,t=new X.a.Map({container:"mapBoxMap",style:H,minZoon:3,maxZoom:24,zoom:17,center:[108.94400235446722,34.300590391379714]});t.on("load",function(){t.addSource("building",{type:"geojson",data:null}),t.addSource("poi-face",{type:"geojson",data:null}),t.addSource("link",{type:"geojson",data:null}),t.addSource("poi",{type:"geojson",data:null}),t.addLayer({id:"building-layer",type:"fill",source:"building",layout:{},paint:{"fill-color":"#666","fill-opacity":.2}}),t.addLayer({id:"poi-face-layer",type:"fill",source:"poi-face",layout:{},paint:{"fill-outline-color":"#999","fill-color":"#999","fill-opacity":.2}}),t.addLayer({id:"link-layer",type:"line",source:"link",layout:{},paint:{"line-opacity":.8,"line-color":"#aaa","line-width":2}}),t.addLayer({id:"poi-layer",type:"circle",source:"poi",layout:{},paint:{"circle-radius":2,"circle-color":"#000"}}),t.addLayer({id:"poi-symbol-layer",type:"symbol",source:"poi",layout:{"text-field":"{name}","text-font":["Open Sans Regular","Arial Unicode MS Regular"],"text-size":12,"text-offset":[0,0],"text-anchor":"top"},paint:{}}),e.loadBuilding(6101000094).then(function(e){e&&(t.getSource("building").setData(e),t.flyTo({center:e.properties.center}))}),e.loadPoiFace(61010000941001).then(function(e){e&&t.getSource("poi-face").setData({type:"FeatureCollection",features:e})}),e.loadLink(61010000941001).then(function(e){e&&t.getSource("link").setData({type:"FeatureCollection",features:e})}),e.loadPoi(61010000941001).then(function(e){e&&t.getSource("poi").setData({type:"FeatureCollection",features:e})})}),t.on("zoomend",function(e){console.log(t.getZoom())})},loadBuilding:function(e){return j.get("/indoor/building/".concat(e)).then(function(e){if(e&&e.data&&e.data.length>0){var t=e.data[0];return{type:"Feature",properties:{id:t.id,kind:t.kind,name:t.name,center:t.center_coordinate.split(",").map(function(e){return parseFloat(e)})},geometry:S.wktToGeojson(t.geometry)}}return null}).catch(function(e){return console.error(e),null})},loadPoiFace:function(e){return j.get("/indoor/building/floor/poiFace/".concat(e)).then(function(e){return e&&e.data&&e.data.length>0?e.data.map(function(e){return{type:"Feature",properties:{id:e.face_id,kind:e.kind},geometry:S.wktToGeojson(e.geometry)}}):null}).catch(function(e){return console.error(e),null})},loadLink:function(e){return j.get("/indoor/building/floor/link/".concat(e)).then(function(e){return e&&e.data&&e.data.length>0?e.data.map(function(e){return{type:"Feature",properties:{id:e.link_id,kind:e.kind,type:e.type,snodeId:e.snode_id,enodeId:e.enode_id},geometry:S.wktToGeojson(e.geometry)}}):null}).catch(function(e){return console.error(e),null})},loadPoi:function(e){return j.get("/indoor/building/floor/poi/".concat(e)).then(function(e){return e&&e.data&&e.data.length>0?e.data.map(function(e){var t=S.wktToGeojson(e.geometry);return{type:"Feature",properties:{id:e.id,kind:e.kind,name:e.name,faceId:e.face_id},geometry:t}}):null}).catch(function(e){return console.error(e),null})}}},K=V,W=(n("4fdf"),Object(N["a"])(K,D,q,!1,null,"356b559c",null));W.options.__file="MapBoxMap.vue";var $=W.exports,ee=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container"},[n("app-header"),n("div",{staticClass:"map-container",attrs:{id:"leafletMap"}}),n("router-view")],1)},te=[],ne=n("a322"),oe=n("e11e"),ae=n.n(oe),ie=(n("6cc5"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("mt-header",{attrs:{title:e.title}},[n("router-link",{attrs:{slot:"left",to:"/"},slot:"left"},[n("mt-button",{attrs:{icon:"back"}})],1)],1)}),re=[],ce={name:"appHeader",props:{},data:function(){return{title:null}},methods:{},mounted:function(){this.title=this.$route.query.name}},le=ce,se=(n("83ae"),Object(N["a"])(le,ie,re,!1,null,"24b47fb1",null));se.options.__file="header.vue";var ue=se.exports;ae.a.Icon.Default.prototype.options.imagePath="/res/leaflet/images/";var de={name:"LeafletMap",props:{},components:{appHeader:ue},data:function(){return{map:null,layers:[]}},mounted:function(){var e=this;if(this.createMap(),this.$bus.$on(d.FLOORCHANGING,function(t){e.loadFeatures(t)}),"/map/info"===this.$route.path&&this.showBuilding(),"/map/point"===this.$route.path){this.showBuilding(),this.loadFeatures(61010000941002);var t=null;this.map.panTo([34.300590391379714,108.94400235446722]),t=ae.a.marker([34.300590391379714,108.94400235446722]).addTo(this.map),this.$bus.$emit(d.GETNEARPOINTS,["耐克","阿迪达斯","美津浓","彪马","安踏"]),this.map.on("click",function(n){var o=n.latlng.lat,a=n.latlng.lng;t&&e.map.removeLayer(t),e.map.panTo([o,a]),t=ae.a.marker([o,a]).addTo(e.map),e.$bus.$emit(d.GETNEARPOINTS,["耐克","阿迪达斯","李宁","联想"])})}},destroyed:function(){this.$bus.$off(d.FLOORCHANGING)},methods:{createMap:function(){this.map=ae.a.map("leafletMap",{minZoom:5,maxZoom:24,zoomControl:!1,attributionControl:!1}).setView([34.300590391379714,108.94400235446722],17),ae.a.tileLayer("http://{s}.map.gtimg.com/realtimerender?z={z}&x={x}&y={y}&type=vector&style=0",{minZoom:5,maxZoom:18,id:"mapbox.streets",subdomains:["rt0","rt1","rt2","rt3"],tms:!0}).addTo(this.map)},showBuilding:function(){var e=this,t=this.$route.query.id?this.$route.query.id:6101000094;if(!t)throw Error("不是一个有效的商场id");this.loadBuilding(t).then(function(t){t&&(t.layer.addTo(e.map),e.map.setView(t.center,19))})},loadBuilding:function(e){return j.get("/indoor/building/".concat(e)).then(function(e){if(e&&e.data&&e.data.length>0){var t={style:{color:"#d1a990",fill:!0,fillColor:"#f8c0e3",fillOpacity:.2}},n={type:"Feature",properties:{id:e.data[0].building_id,kind:e.data[0].kind,name:e.data[0].name,center:e.data[0].center_coordinate.split(",").map(function(e){return parseFloat(e)}).reverse()},geometry:S.wktToGeojson(e.data[0].geometry)},o=ae.a.geoJSON(n,t);return{layer:o,center:n.properties.center}}return null}).catch(function(e){return console.error(e),null})},loadFeatures:function(e){this.layers.forEach(function(e){e&&e.remove()}),this.layers=[];var t=this,n=[this.loadPoiFace(e),this.loadLink(e),this.loadPoi(e)];Promise.all(n).then(function(e){e.forEach(function(e){t.layers=t.layers.concat(e)}),t.layers.forEach(function(e){e&&e.addTo&&e.addTo(t.map)})})},loadPoiFace:function(e){return j.get("/indoor/building/floor/poiFace/".concat(e)).then(function(e){if(e&&e.data&&e.data.length>0){var t,n=(t={9203002:"#fd7676",9205000:"#ddd",1103003:"#befe73",1102000:"#befe73",1103001:"#befe73",1303014:"#f69d70",1303004:"#d9ceff",1303020:"#f1d35b",1303005:"#f69d70",1303015:"#fe9104"},Object(ne["a"])(t,"1303020","#c6a5a3"),Object(ne["a"])(t,1303001,"#fb8ec6"),Object(ne["a"])(t,1303002,"#c6a5a3"),Object(ne["a"])(t,1304e3,"#81effe"),Object(ne["a"])(t,1303e3,"#f69d70"),Object(ne["a"])(t,1306004,"#04feef"),Object(ne["a"])(t,1303007,"#f1d35b"),Object(ne["a"])(t,2707e3,"#affed1"),Object(ne["a"])(t,2301e3,"#d9ceff"),Object(ne["a"])(t,1303009,"#f69d70"),t),o=e.data.map(function(e){return{type:"Feature",properties:{id:e.face_id,poiId:e.poi_id,poiKind:e.poi_kind},geometry:S.wktToGeojson(e.geometry)}}),a={style:function(e){return{color:"#cecece",fill:!0,fillColor:n[e.properties.poiKind]?n[e.properties.poiKind]:"#f1d35b",fillOpacity:.9}}};return[ae.a.geoJSON(o,a)]}return null}).catch(function(e){return console.error(e),null})},loadLink:function(e){return j.get("/indoor/building/floor/link/".concat(e)).then(function(e){if(e&&e.data&&e.data.length>0){var t=e.data.map(function(e){return{type:"Feature",properties:{id:e.link_id,kind:e.kind,type:e.type,snodeId:e.snode_id,enodeId:e.enode_id},geometry:S.wktToGeojson(e.geometry)}}),n={style:{color:"#fff"}};return[ae.a.geoJSON(t,n)]}return null}).catch(function(e){return console.error(e),null})},loadPoi:function(e){var t=this;return j.get("/indoor/building/floor/poi/".concat(e)).then(function(e){if(e&&e.data&&e.data.length>0){var n=e.data.map(function(e){var t=S.wktToGeojson(e.geometry);return{type:"Feature",properties:{id:e.poi_id,kind:e.kind,name:e.name,faceId:e.face_id},geometry:t}}),o=ae.a.geoJSON(n,{style:{radius:2,color:"#000",fill:!0,fillColor:"#000",fillOpacity:1},pointToLayer:function(e,n){var o=ae.a.circleMarker(n);return o.on("click",function(e){t.$bus.$emit(d.SELECTPOI,e.target.feature)}),o}}),a=ae.a.geoJSON(n,{pointToLayer:function(e,t){var n=ae.a.divIcon({html:e.properties.name,className:"div-icon",iconSize:[50,20],iconAnchor:[25,-5]});return ae.a.marker(t,{icon:n})}});return[a,o]}return null}).catch(function(e){return console.error(e),null})}}},pe=de,fe=(n("ec38"),Object(N["a"])(pe,ee,te,!1,null,"2e47dc14",null));fe.options.__file="LeafletMap.vue";var me=fe.exports,he=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"map-container",attrs:{id:"mineMap"}})},ge=[];minemap.domainUrl="http://139.199.20.29",minemap.serviceUrl="http://139.199.20.29/service",minemap.spriteUrl="http://139.199.20.29/app/images/map/sprite",minemap.accessToken="6cbcf83014ca4d2abbe758e02c9e3dbe";var ye={name:"MineMap",props:{},mounted:function(){this.createMap()},methods:{createMap:function(){minemap.solution=4791;new minemap.Map({container:"mineMap",style:"http://139.199.20.29/service/solu/style/id/4791",minZoon:3,maxZoom:24,zoom:16,center:[108.94400235446722,34.300590391379714]})}}},ve=ye,Ae=(n("ad63"),Object(N["a"])(ve,he,ge,!1,null,"1482816d",null));Ae.options.__file="MineMap.vue";var be=Ae.exports,Pe=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"BuildingList",attrs:{id:"shop"}},[o("img",{staticClass:"imglogo",attrs:{src:n("cf05"),width:"38px",height:"38px"}}),e._l(e.buildings,function(t){return o("div",{on:{click:function(n){e.toMap(t)}}},[o("mt-cell",{attrs:{title:t.name,label:t.address,"is-link":""}})],1)})],2)},we=[],ke={name:"HelloWorld",data:function(){return{buildings:[]}},props:{},mounted:function(){var e=this;this.loadBuilding().then(function(t){t&&(e.buildings=t)})},methods:{toMap:function(e){this.$router.push({path:"/map/info",query:{id:e.building_id,name:e.name}})},loadBuilding:function(e){return j.get("/indoor/building").then(function(e){return e&&e.data?e.data:null}).catch(function(e){return console.error(e),null})}}},Te=ke,je=(n("0ee5"),Object(N["a"])(Te,Pe,we,!1,null,"780c0c84",null));je.options.__file="BuildingList.vue";var Fe=je.exports,Oe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{directives:[{name:"show",rawName:"v-show",value:e.searchContainer,expression:"searchContainer"}],staticClass:"searchContainer"},[n("div",{staticClass:"searchPanel"},[n("div",[n("input",{directives:[{name:"model",rawName:"v-model",value:e.startPlace,expression:"startPlace"}],attrs:{type:"input",placeholder:"输入起点"},domProps:{value:e.startPlace},on:{input:[function(t){t.target.composing||(e.startPlace=t.target.value)},function(t){e.queryPlace("start")}]}})]),n("div",[n("input",{directives:[{name:"model",rawName:"v-model",value:e.endPlace,expression:"endPlace"}],attrs:{type:"input",placeholder:"输入终点"},domProps:{value:e.endPlace},on:{input:[function(t){t.target.composing||(e.endPlace=t.target.value)},function(t){e.queryPlace("end")}]}})])]),n("div",{staticClass:"searchType"},[n("span",{on:{click:function(t){e.switchMode(t.target,"name")}}},[e._v("名称搜索")]),n("span",{on:{click:function(t){e.switchMode(t.target,"search")}}},[e._v("地图选点")])]),n("div",{staticClass:"resultPanel"},[n("ul",e._l(e.placeList,function(t){return n("li",{on:{click:function(n){e.selectPlace(t)}}},[e._v(e._s(t.name))])}))])]),n("div",{staticClass:"map-container",attrs:{id:"leafletMap"}})])},Ce=[],xe={name:"PlaceSearch",props:{},data:function(){return{placeList:[],searchType:"start",startPlace:"",endPlace:"",searchContainer:!0}},mounted:function(){this.switchMode(document.querySelectorAll(".searchType span")[0],"name")},methods:{queryPlace:function(e){var t=this,n=this.startPlace;if("end"===e&&(n=this.endPlace),""!==n){this.searchType=e;var o={buildingId:this.$route.query.id,tip:n};j.get("/indoor/building/search/poi/",o).then(function(e){e.data&&0!==e.data.length?t.placeList=e.data:t.placeList=[]})}else this.placeList=[]},selectPlace:function(e){"start"===this.searchType?this.startPlace=e.name:this.endPlace=e.name,""!==this.startPlace&&""!==this.endPlace&&(this.$router.push("/map"),this.showPathOnMap())},switchMode:function(e,t){document.querySelectorAll(".searchType span").forEach(function(e){e.classList.remove("select")}),e.classList.add("select")},showPathOnMap:function(){var e=[[40,114],[43.2,119],[38.3,128]],t=new ae.a.Polyline(e,{color:"#f00",weight:2});setTimeout(function(){me.methods.getMapObj().addLayer(t)})}}},Se=xe,Be=(n("9207"),Object(N["a"])(Se,Oe,Ce,!1,null,"2a088cd7",null));Be.options.__file="PlaceSearch.vue";var _e=Be.exports,Me=[{path:"/",component:Fe},{path:"/map",component:me,children:[{path:"info",component:I},{path:"point",component:Q}]},{path:"/mapbox",component:$},{path:"/minmap",component:be},{path:"/search",component:_e}],Ne=new r["a"]({routes:Me}),Le={name:"app",router:Ne},Ie=Le,Ge=(n("034f"),Object(N["a"])(Ie,c,l,!1,null,null,null));Ge.options.__file="App.vue";var Re=Ge.exports,Ue=function(e){var t=new e({methods:{emit:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];this.$emit.apply(this,[e].concat(n))},on:function(e,t){this.$on(e,t)},off:function(e,t){this.$off(e,t)}}});e.prototype.$bus=t},Ee=Ue;apiready=function(){console.log(api.appId)},o["default"].config.productionTip=!1,o["default"].use(i.a),o["default"].use(Ee),o["default"].use(r["a"]),new o["default"]({render:function(e){return e(Re)}}).$mount("#app")},"82b9":function(e,t,n){},"83ae":function(e,t,n){"use strict";var o=n("1ff7"),a=n.n(o);a.a},"84fe":function(e,t,n){},9207:function(e,t,n){"use strict";var o=n("ac77"),a=n.n(o);a.a},ac39:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAQ1SURBVGhD7ZpLqFVVGMevVpphpJVYSQZlaEUNBGmkNhIKEhuk1qSCKEjQkhwaFKWCBtILFbJBoqgNemuDKCJn6qBJFlhgapRZUaD59vdb9MHh3HPP3Y91zt2If/jBXWufvdb69np961t34LIuYU2FJ2ETfA1H4R+4AGfhTzgAH8IqmAfXQCN0PbwA+8AGl+UEbIMHYRT0XTfCWvgXolHHYAcsgQfgFrgaQtfBDFgAr8K3YE/F+9/BQuiLQVbyDBwHKz8PDpWH4SooK41dDj9BGOSwvAt6JnvhU4gKP4J7IYeuhCfgCFj2SfCDZdfdcAis5FewB3qh8fAm2NPW9S5oZBbNghhKX8JN0Gs5j/4C6/wExkAtOXR+Bwt0daldYAndBy7h1v0BXAGV5JyI4bQFRkO/NQ3iQ75uRlm5On0GFvAV9LMn2nU/uN84b+abUUauGBrhxJ5sxgjrWbA99s4NZhTRJPgDfLFXq1MVxdK/IaUKyB3bF9wnmqTbwf1Fb+BOM7pJ30m3w/GYa7PLqTfAj+z+0lXPQ+7emABV3JdOuhXOgD1juUNqP+ScGw+BK85emGhGBrlB2sYhXZjbwB840XN8QY04BZYpuvo5jHkMLO/zlOogD0X+YHtK1VOrEZvh4P9/5zDG5fcceGjr+ME3gpV5nqijViPeAjdXT485jfHsYlkzU6pN34AP56ZUNXUyIpTTmK1gOQ6zQToMPpySUuXVzYhQLmNeActYmVJtikDBuJQqpyJGhHIYsxR8f11KtckHTqKyKmNEqNWYKkvzU+C776RUm9xofFhGVYwI1TEmnMi3U6pNcSIz2lFEdYwIVTXmRfCd1SnVpu/Bh57Ph5MV6ibUMSLUasx7ZhTQevD3y1KqTfpXPixyePHY+T68DHWMCGnMx7A4pYZXHPocFYP0GvjQ4FmT5YeL468fYJCMxfpwT0o1Vx4vbKfDsaMMKOupenC52YyGyk1QQ7qeFA35+CNXhSbKYfUj2MaurpRRcX9kLDZbhC+jnNy272fousj4MDxL3fqmyflr255LqWH0KPhjnchrzWiIHgfb9QsU8gftFUP7vmRAuQky6hnh06J7TdI94M5dKbqXWX7Y2AC/MKOswjH7G0YyNKQ/ZTvskcpRT30fC3FcTjejz/I2y/rd3+qcXJNPFT6YboF3Jf2Qw2kNWK8bdJbhPRZ2goX27EqsRUZJIs5rfY9ANtkzHivjSsyK7oDccomN1cmbgNnQE3kl5jW0FTlujcV29EBLSo8iNjvZDT2/4jPQbQws7shPg8uj67vrfRE5B1wJdQB/gDDAW91F0FcZ2jeK+B9EQwxe6OLofHroMtrxNDivVoAnu13wG8Q7ou9kYLD1Hwz6Ls/4NtReaf1PiOHwPGHPzoGRuJ/sKj1mw5hGAF8CL41srNEOl1OvLZwPXg9c1iWsgYGLM6hJAFVo6r0AAAAASUVORK5CYII="},ac77:function(e,t,n){},ad63:function(e,t,n){"use strict";var o=n("48cd"),a=n.n(o);a.a},afd3:function(e,t,n){"use strict";var o=n("4ab0"),a=n.n(o);a.a},c751:function(e,t,n){"use strict";var o=n("84fe"),a=n.n(o);a.a},cf05:function(e,t,n){e.exports=n.p+"82b9c7a5a3f405032b1db71a25f67021.png"},dcc8:function(e,t,n){},ec38:function(e,t,n){"use strict";var o=n("4af2"),a=n.n(o);a.a}});
//# sourceMappingURL=app.cb8d0e8e.js.map